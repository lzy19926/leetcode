<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>


        // LRU缓存(见Notion知识点)

        var LRUCache = function (capacity) {
            this._capacity = capacity
            this._cache = new Map()
            this._count = 0
        };

        LRUCache.prototype.get = function (key) {
            debugger
            let val = this._cache.get(key)

            if (!val) {
                return -1
            } else { // 更新时间戳
                val.time = Date.now()
                this._cache.set(key, val)
                return val.value
            }
        };


        LRUCache.prototype.put = function (key, value) {

            // 超过缓存上限则删除
            if (this._count >= this._capacity) {
                // 找到最长时间未使用的数据
                let maxUnusedItem = null
                for (let item of this._cache) {
                    if (!maxUnusedItem) { maxUnusedItem = item }

                    else if (maxUnusedItem[1].time > item[1].time) {
                        maxUnusedItem = item
                    }
                }

                // 删除该数据
                this._cache.delete(maxUnusedItem[0])
            }

            // 设置数据
            this._cache.set(key, { value, time: Date.now() })
            this._count++
        };


        let cache = new LRUCache(2)

        console.log(cache.put(1, 1));
        console.log(cache.put(2, 2));
        console.log(cache.get(1));
        console.log(cache.put(3, 3));
        console.log(cache.get(2));
        console.log(cache.put(4, 4));
        console.log(cache.get(1))
        console.log(cache.get(3))
        console.log(cache.get(4))

    </script>
</body>

</html>