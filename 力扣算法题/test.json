

/**
 * 根据certInfo创建LicenseData
 * @param {Object} certInfo - 接口获取的原始证书数据
 */
async function createLicenseData() {

    let licenseData = {}

    const createResult = assignRes => ({
        status: assignRes.status,
        licenseData: assignRes.licenseData,
        msg: assignRes.msg
    })

    //校验并合并certInfo部分参数到licenseData中
    const firstAssignRes = await this._assignCertInfoToLicenseData(licenseData, certInfo)
    if (firstAssignRes.status == false) {
        return createResult(firstAssignRes)
    }

    //校验并合并自定义参数到licenseData中,并设置缓存key
    const secondAssignRes = await this._assignCustomAttrToLicenseData(licenseData, true);
    if (secondAssignRes.status == false) {
        return createResult(firstAssignRes)
    }

    return createResult(firstAssignRes)
}
